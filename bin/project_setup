#!/bin/bash

[ -f "README.md" ] || touch README.md
[ -f "GEMINI.md" ] || touch GEMINI.md
# ln -sf README.md AGENTS.md
# ln -sf README.md GEMINI.md
# ln -sf README.md CLAUDE.md

# Initialize documentation files if they don't exist
[ ! -f "README.todo" ] && echo -e "TODO:\n    â˜ " > README.todo
[ ! -f "README.task.md" ] && cat <<EOF > README.task.md
# Tasks

context: ./@README.md  and ./@README*.md in the same folder

## Sample Task(ignore)

Parameters:

- location: (default:Taipei Taiwan)
- type: (default:all)
- number of result: (default:10)

do some sample reasearch and follow the README.template.md to product the result
EOF

# Handle legacy symbolic link or mapping
if [ -L ".agents" ]; then
  echo "Removing existing .agents symbolic link..."
  rm ".agents"
fi

if [ -d ".agent" ] && [ ! -d ".agents" ]; then
  echo "Moving .agent directory to .agent..."
  mv ".agent" ".agents"
fi

# .agent setup , due to Antigravity can't recognize symbolic link
mkdir -p .agents/workflows
mkdir -p .agents/rules
mkdir -p .agents/skills

if [ ! -f ".agents/settings.json" ]; then

cat <<EOF > .agents/settings.json
{
  "mcp": {
    "excluded": [
    ]
  },
  "mcpServers": {
  }
}
EOF

fi

# symbolic link
ln -sfh .agents .gemini
ln -sfh .agents .agent
# ln -sfh .agent .agents
# ln -sh .agent .claude

ln -sfh .gitignore .geminiignore


project_path=$(pwd)
project_name=$(basename "$project_path")

if [ -d "$HOME/projects/llm_plugin" ]; then
  ln -sfh "$(pwd)/.agent" "$HOME/projects/llm_plugin/projects/${project_name}"
fi


