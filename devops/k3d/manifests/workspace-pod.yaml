apiVersion: v1
kind: Pod
metadata:
  name: workspace-PROJECT_NAME
  namespace: dev
  labels:
    app: workspace
    project: PROJECT_NAME
    role: debug
spec:
  initContainers:
    - name: copy-workspace
      image: ubuntu:24.04
      command:
        [
          "sh",
          "-c",
          "mkdir -p /home/shuk/projects/PROJECT_NAME && cp -a /source/. /home/shuk/projects/PROJECT_NAME/"
        ]
      volumeMounts:
        - name: source-vol
          mountPath: /source
          readOnly: true
        - name: workspace-vol
          mountPath: /home/shuk/projects
  containers:
    - name: workspace
      image: ubuntu:24.04
      command: ["sleep", "infinity"]
      volumeMounts:
        - name: workspace-vol
          mountPath: /home/shuk/projects
      resources:
        limits:
          memory: "512Mi"
          cpu: "500m"
  volumes:
    - name: source-vol
      hostPath:
        path: /projects/PROJECT_NAME
        type: Directory
    - name: workspace-vol
      emptyDir: {}
